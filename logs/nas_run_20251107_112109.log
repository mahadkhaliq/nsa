2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] NAS with Approximate Multipliers - Started
2025-11-07 11:21:09 [INFO] Log file: logs/nas_run_20251107_112109.log
2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] CONFIGURATION
2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] Dataset: cifar10
2025-11-07 11:21:09 [INFO] Training samples: 5000
2025-11-07 11:21:09 [INFO] Validation samples: 1000
2025-11-07 11:21:09 [INFO] NAS trials: 20
2025-11-07 11:21:09 [INFO] NAS blocks: 4
2025-11-07 11:21:09 [INFO] NAS method: evolutionary
2025-11-07 11:21:09 [INFO] Training epochs: 50
2025-11-07 11:21:09 [INFO] Batch size: 128
2025-11-07 11:21:09 [INFO] Multiplier dir: ./multipliers
2025-11-07 11:21:09 [INFO] 
======================================================================
2025-11-07 11:21:09 [INFO] STEP 0: Loading Dataset
2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] Input shape: (32, 32, 3)
2025-11-07 11:21:09 [INFO] Number of classes: 10
2025-11-07 11:21:09 [INFO] Training samples (full): 44000
2025-11-07 11:21:09 [INFO] Validation samples (full): 6000
2025-11-07 11:21:09 [INFO] Test samples: 10000
2025-11-07 11:21:09 [INFO] 
Using subset:
2025-11-07 11:21:09 [INFO]   Training: 5000 samples
2025-11-07 11:21:09 [INFO]   Validation: 1000 samples
2025-11-07 11:21:09 [INFO] 
======================================================================
2025-11-07 11:21:09 [INFO] STEP 1: Neural Architecture Search
2025-11-07 11:21:09 [INFO] ======================================================================
2025-11-07 11:21:09 [INFO] Starting NAS: STANDARD - Method: EVOLUTIONARY

2025-11-07 11:21:09 [INFO] Phase 1: Generating initial population (4 architectures)
2025-11-07 11:21:12 [INFO] Init 1/4: Accuracy 0.2720
2025-11-07 11:21:16 [INFO] Init 2/4: Accuracy 0.1400
2025-11-07 11:21:18 [INFO] Init 3/4: Accuracy 0.0930
2025-11-07 11:21:19 [INFO] Init 4/4: Accuracy 0.1640
2025-11-07 11:21:19 [INFO] 
Phase 2: Evolution (16 generations)
2025-11-07 11:21:20 [INFO] Trial 5/20
2025-11-07 11:21:20 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'avg_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}]
2025-11-07 11:21:20 [INFO]   Accuracy: 0.2460
2025-11-07 11:21:21 [INFO] Trial 6/20
2025-11-07 11:21:21 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:21 [INFO]   Accuracy: 0.2240
2025-11-07 11:21:23 [INFO] Trial 7/20
2025-11-07 11:21:23 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:23 [INFO]   Accuracy: 0.2030
2025-11-07 11:21:24 [INFO] Trial 8/20
2025-11-07 11:21:24 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:24 [INFO]   Accuracy: 0.2410
2025-11-07 11:21:25 [INFO] Trial 9/20
2025-11-07 11:21:25 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:25 [INFO]   Accuracy: 0.2140
2025-11-07 11:21:30 [INFO] Trial 10/20
2025-11-07 11:21:30 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:30 [INFO]   Accuracy: 0.2670
2025-11-07 11:21:31 [INFO] Trial 11/20
2025-11-07 11:21:31 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'avg_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}]
2025-11-07 11:21:31 [INFO]   Accuracy: 0.2150
2025-11-07 11:21:32 [INFO] Trial 12/20
2025-11-07 11:21:32 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'avg_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}]
2025-11-07 11:21:32 [INFO]   Accuracy: 0.2000
2025-11-07 11:21:33 [INFO] Trial 13/20
2025-11-07 11:21:33 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:33 [INFO]   Accuracy: 0.2240
2025-11-07 11:21:34 [INFO] Trial 14/20
2025-11-07 11:21:34 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:34 [INFO]   Accuracy: 0.2590
2025-11-07 11:21:36 [INFO] Trial 15/20
2025-11-07 11:21:36 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:36 [INFO]   Accuracy: 0.2200
2025-11-07 11:21:37 [INFO] Trial 16/20
2025-11-07 11:21:37 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:37 [INFO]   Accuracy: 0.2240
2025-11-07 11:21:41 [INFO] Trial 17/20
2025-11-07 11:21:41 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:41 [INFO]   Accuracy: 0.2110
2025-11-07 11:21:43 [INFO] Trial 18/20
2025-11-07 11:21:43 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:43 [INFO]   Accuracy: 0.2050
2025-11-07 11:21:44 [INFO] Trial 19/20
2025-11-07 11:21:44 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'avg_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}]
2025-11-07 11:21:44 [INFO]   Accuracy: 0.2190
2025-11-07 11:21:47 [INFO] Trial 20/20
2025-11-07 11:21:47 [INFO]   Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:47 [INFO]   Accuracy: 0.2300
2025-11-07 11:21:47 [INFO] 
Top 3 Architectures:
2025-11-07 11:21:47 [INFO] 1. Accuracy: 0.2670
2025-11-07 11:21:47 [INFO]    [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:47 [INFO] 2. Accuracy: 0.2590
2025-11-07 11:21:47 [INFO]    [{'op': 'conv1x1', 'filters': 64, 'use_bn': False}, {'op': 'max_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:47 [INFO] 3. Accuracy: 0.2460
2025-11-07 11:21:47 [INFO]    [{'op': 'conv1x1', 'filters': 32, 'use_bn': False}, {'op': 'avg_pool', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 128, 'use_bn': False}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}]
2025-11-07 11:21:47 [INFO] 
======================================================================
2025-11-07 11:21:47 [INFO] STEP 2: Training Best Architecture
2025-11-07 11:21:47 [INFO] ======================================================================
2025-11-07 11:21:47 [INFO] Best Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:21:47 [INFO] 
Model Complexity:
2025-11-07 11:21:47 [INFO]   Trainable Parameters: 103,338
2025-11-07 11:21:47 [INFO]   Estimated FLOPs: 90,275,840
2025-11-07 11:21:47 [INFO]   Model Size (approx): 0.39 MB (float32)
2025-11-07 11:21:47 [INFO] 
Training for 50 epochs...
2025-11-07 11:22:16 [INFO] Training completed: 50 epochs
2025-11-07 11:22:16 [INFO] ✓ Standard model accuracy: 0.5320
2025-11-07 11:22:16 [INFO] 
============================================================
2025-11-07 11:22:16 [INFO] BEST ARCHITECTURE FOUND
2025-11-07 11:22:16 [INFO] ============================================================
2025-11-07 11:22:16 [INFO] Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:22:16 [INFO] Accuracy: 0.5320
2025-11-07 11:22:16 [INFO] ============================================================
2025-11-07 11:22:16 [INFO] 
Training Summary:
2025-11-07 11:22:16 [INFO]   Final Training Accuracy: 0.5874
2025-11-07 11:22:16 [INFO]   Final Validation Accuracy: 0.5320
2025-11-07 11:22:16 [INFO]   Final Training Loss: 1.1214
2025-11-07 11:22:16 [INFO]   Final Validation Loss: 1.3303
2025-11-07 11:22:16 [INFO] 
======================================================================
2025-11-07 11:22:16 [INFO] STEP 3: Testing Approximate Multipliers
2025-11-07 11:22:16 [INFO] ======================================================================
2025-11-07 11:22:16 [INFO] Found 36 multipliers to test
2025-11-07 11:22:16 [INFO] Standard model accuracy: 0.5320

2025-11-07 11:22:16 [INFO] [1/36] Testing: mul8u_125K.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [2/36] Testing: mul8u_12N4.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [3/36] Testing: mul8u_13QR.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [4/36] Testing: mul8u_1446.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [5/36] Testing: mul8u_14VP.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [6/36] Testing: mul8u_150Q.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [7/36] Testing: mul8u_17C8.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [8/36] Testing: mul8u_17KS.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [9/36] Testing: mul8u_17QU.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [10/36] Testing: mul8u_185Q.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [11/36] Testing: mul8u_18DU.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [12/36] Testing: mul8u_199Z.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [13/36] Testing: mul8u_19DB.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [14/36] Testing: mul8u_1AGV.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [15/36] Testing: mul8u_1JFF.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [16/36] Testing: mul8u_2AC.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [17/36] Testing: mul8u_2HH.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [18/36] Testing: mul8u_2P7.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [19/36] Testing: mul8u_7C1.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [20/36] Testing: mul8u_96D.bin
2025-11-07 11:22:16 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:16 [INFO] [21/36] Testing: mul8u_CK5.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [22/36] Testing: mul8u_DM1.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [23/36] Testing: mul8u_EXZ.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [24/36] Testing: mul8u_FTA.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [25/36] Testing: mul8u_GS2.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [26/36] Testing: mul8u_JQQ.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [27/36] Testing: mul8u_JV3.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [28/36] Testing: mul8u_KEM.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [29/36] Testing: mul8u_L40.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [30/36] Testing: mul8u_NGR.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [31/36] Testing: mul8u_PKY.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [32/36] Testing: mul8u_QJD.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [33/36] Testing: mul8u_QKX.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [34/36] Testing: mul8u_Y48.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [35/36] Testing: mul8u_YX7.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] [36/36] Testing: mul8u_ZFB.bin
2025-11-07 11:22:17 [INFO]   ✗ Failed to build model: 'depthwise_sep'

2025-11-07 11:22:17 [INFO] 
======================================================================
2025-11-07 11:22:17 [INFO] STEP 4: Results Analysis
2025-11-07 11:22:17 [INFO] ======================================================================
2025-11-07 11:22:17 [INFO] ⚠ No multipliers were successfully tested
2025-11-07 11:22:17 [INFO] 
======================================================================
2025-11-07 11:22:17 [INFO] FINAL SUMMARY
2025-11-07 11:22:17 [INFO] ======================================================================
2025-11-07 11:22:17 [INFO] Dataset: cifar10
2025-11-07 11:22:17 [INFO] Best Architecture: [{'op': 'conv1x1', 'filters': 32, 'use_bn': True}, {'op': 'conv3x3', 'filters': 128, 'use_bn': False}, {'op': 'depthwise_sep', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 32, 'use_bn': False}]
2025-11-07 11:22:17 [INFO] Standard Model Accuracy: 0.5320
2025-11-07 11:22:17 [INFO] Model Parameters: 103,338
2025-11-07 11:22:17 [INFO] Estimated FLOPs: 90,275,840
2025-11-07 11:22:17 [INFO] 
✓ Results saved to: logs/nas_results_20251107_112109.json
2025-11-07 11:22:17 [INFO] 
======================================================================
2025-11-07 11:22:17 [INFO] NAS Run Completed
2025-11-07 11:22:17 [INFO] Log file: logs/nas_run_20251107_112109.log
2025-11-07 11:22:17 [INFO] ======================================================================
2025-11-07 11:22:17 [INFO] 
✓ All done!
