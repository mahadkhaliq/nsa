2025-11-10 00:22:01 [INFO] ======================================================================
2025-11-10 00:22:01 [INFO] NAS with Approximate Multipliers - Started
2025-11-10 00:22:01 [INFO] Log file: logs/nas_run_20251110_002201.log
2025-11-10 00:22:01 [INFO] ======================================================================
2025-11-10 00:22:01 [INFO] ======================================================================
2025-11-10 00:22:01 [INFO] CONFIGURATION
2025-11-10 00:22:01 [INFO] ======================================================================
2025-11-10 00:22:01 [INFO] Dataset: mnist
2025-11-10 00:22:01 [INFO] Training samples: 5000
2025-11-10 00:22:01 [INFO] Validation samples: 1000
2025-11-10 00:22:01 [INFO] NAS trials: 5
2025-11-10 00:22:01 [INFO] NAS blocks: 4
2025-11-10 00:22:01 [INFO] NAS method: evolutionary
2025-11-10 00:22:01 [INFO] Training epochs: 30
2025-11-10 00:22:01 [INFO] Batch size: 128
2025-11-10 00:22:01 [INFO] Learning rate: 0.001
2025-11-10 00:22:01 [INFO] LR scheduling: No
2025-11-10 00:22:01 [INFO] Multiplier dir: ./multipliers
2025-11-10 00:22:01 [INFO] Save predictions: No
2025-11-10 00:22:01 [INFO] Results dir: logs/results
2025-11-10 00:22:01 [INFO] 
======================================================================
2025-11-10 00:22:01 [INFO] STEP 0: Loading Dataset
2025-11-10 00:22:01 [INFO] ======================================================================
2025-11-10 00:22:02 [INFO] Input shape: (28, 28, 1)
2025-11-10 00:22:02 [INFO] Number of classes: 10
2025-11-10 00:22:02 [INFO] Training samples (full): 54000
2025-11-10 00:22:02 [INFO] Validation samples (full): 6000
2025-11-10 00:22:02 [INFO] Test samples: 10000
2025-11-10 00:22:02 [INFO] 
Using subset:
2025-11-10 00:22:02 [INFO]   Training: 5000 samples
2025-11-10 00:22:02 [INFO]   Validation: 1000 samples
2025-11-10 00:22:02 [INFO]   Classes: 0, 1, 2, 3, 4...
2025-11-10 00:22:02 [INFO] 
======================================================================
2025-11-10 00:22:02 [INFO] STEP 1: Using Predefined Architecture (NAS Skipped)
2025-11-10 00:22:02 [INFO] ======================================================================
2025-11-10 00:22:02 [INFO] Architecture: [{'op': 'conv3x3', 'filters': 64, 'use_bn': True}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 128, 'use_bn': True}, {'op': 'conv1x1', 'filters': 64, 'use_bn': False}]
2025-11-10 00:22:06 [INFO] Quick evaluation accuracy: 0.1040
2025-11-10 00:22:06 [INFO] 
======================================================================
2025-11-10 00:22:06 [INFO] STEP 2: Training Best Architecture
2025-11-10 00:22:06 [INFO] ======================================================================
2025-11-10 00:22:06 [INFO] Best Architecture: [{'op': 'conv3x3', 'filters': 64, 'use_bn': True}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 128, 'use_bn': True}, {'op': 'conv1x1', 'filters': 64, 'use_bn': False}]
2025-11-10 00:22:06 [INFO] 
Model Complexity:
2025-11-10 00:22:06 [INFO]   Trainable Parameters: 223,818
2025-11-10 00:22:06 [INFO]   Estimated FLOPs: 42,198,016
2025-11-10 00:22:06 [INFO]   Model Size (approx): 0.85 MB (float32)
2025-11-10 00:22:06 [INFO] 
Training for 30 epochs...
2025-11-10 00:22:13 [INFO] Training completed: 30 epochs
2025-11-10 00:22:13 [INFO] ✓ Standard model accuracy: 0.9010
2025-11-10 00:22:13 [INFO] 
============================================================
2025-11-10 00:22:13 [INFO] BEST ARCHITECTURE FOUND
2025-11-10 00:22:13 [INFO] ============================================================
2025-11-10 00:22:13 [INFO] Architecture: [{'op': 'conv3x3', 'filters': 64, 'use_bn': True}, {'op': 'max_pool', 'filters': 64, 'use_bn': False}, {'op': 'conv5x5', 'filters': 128, 'use_bn': True}, {'op': 'conv1x1', 'filters': 64, 'use_bn': False}]
2025-11-10 00:22:13 [INFO] Accuracy: 0.9010
2025-11-10 00:22:13 [INFO] ============================================================
2025-11-10 00:22:13 [INFO] 
Training Summary:
2025-11-10 00:22:13 [INFO]   Final Training Accuracy: 0.9230
2025-11-10 00:22:13 [INFO]   Final Validation Accuracy: 0.9010
2025-11-10 00:22:13 [INFO]   Final Training Loss: 0.3228
2025-11-10 00:22:13 [INFO]   Final Validation Loss: 0.3823
2025-11-10 00:22:13 [INFO] 
Saving training curves...
2025-11-10 00:22:13 [INFO]   ✓ Training curves saved to logs/results/
2025-11-10 00:22:13 [INFO] 
✓ Standard model weights saved to logs/results/standard_model_weights.h5
2025-11-10 00:22:13 [INFO] 
======================================================================
2025-11-10 00:22:13 [INFO] STEP 3: Testing Approximate Multipliers
2025-11-10 00:22:13 [INFO] ======================================================================
2025-11-10 00:22:13 [INFO] Found 36 multipliers
2025-11-10 00:22:13 [INFO] Testing first 10 (use --test_all_multipliers to test all)
2025-11-10 00:22:13 [INFO] Testing 10 multipliers
2025-11-10 00:22:13 [INFO] Standard model accuracy: 0.9010
2025-11-10 00:22:13 [INFO] Using saved weights from: logs/results/standard_model_weights.h5

2025-11-10 00:22:13 [INFO] [1/10] Testing: mul8u_125K.bin
2025-11-10 00:22:13 [INFO]   ✓ Weights loaded successfully (no rebuild needed)
2025-11-10 00:22:13 [INFO]   Calibration output range: [0.0343, 0.1931]
2025-11-10 00:22:15 [INFO] Testing: mul8u_125K.bin
2025-11-10 00:22:15 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:15 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:15 [INFO] [2/10] Testing: mul8u_12N4.bin
2025-11-10 00:22:17 [INFO] Testing: mul8u_12N4.bin
2025-11-10 00:22:17 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:17 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:17 [INFO] [3/10] Testing: mul8u_13QR.bin
2025-11-10 00:22:19 [INFO] Testing: mul8u_13QR.bin
2025-11-10 00:22:19 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:19 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:19 [INFO] [4/10] Testing: mul8u_1446.bin
2025-11-10 00:22:21 [INFO] Testing: mul8u_1446.bin
2025-11-10 00:22:21 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:21 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:21 [INFO] [5/10] Testing: mul8u_14VP.bin
2025-11-10 00:22:24 [INFO] Testing: mul8u_14VP.bin
2025-11-10 00:22:24 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:24 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:24 [INFO] [6/10] Testing: mul8u_150Q.bin
2025-11-10 00:22:26 [INFO] Testing: mul8u_150Q.bin
2025-11-10 00:22:26 [INFO]   Accuracy: 0.0892
2025-11-10 00:22:26 [INFO]   Drop:     0.8118 (90.10%)
2025-11-10 00:22:26 [INFO] [7/10] Testing: mul8u_17C8.bin
